# This Dockerfile use the latest Ubuntu Docker Image
FROM ubuntu:latest
ARG DEBIAN_FRONTEND=noninteractive

# ====[ HOST CONFIGURATION ]====
# A. Timezone setup [1]
ENV TZ=Europe/Rome
RUN apt update

# B. Install depenencies 
RUN apt install apache2 -y
RUN apt install php libapache2-mod-php php-bcmath php-curl php-imagick php-intl php-json php-mbstring php-mysql php-xml php-zip -y
# C. Install database MySQL - NO-THREE TIER ARCHITECTURE
#RUN apt install mysql-server -y

# ====[ WEB APP CONFIGURATION ]====
RUN mkdir -p /srv/ftws
#COPY ./ftws /srv/ftws

# ====[ WEB SERVER CONFIGURATION ]====

# |> Configure Web Site in Web Server
COPY ftws-vhost.conf /etc/apache2/sites-available/ftws.conf
RUN a2ensite ftws
RUN chown -R www-data:www-data /srv/ftws
# |> Disable other Web Site default path
RUN a2dissite 000-default
# |> Run the service
CMD ["/usr/sbin/apachectl", "-D", "FOREGROUND"]


# --------------------------
# [1]: Settings for tzdata - https://serverfault.com/questions/949991/how-to-install-tzdata-on-a-ubuntu-docker-image
# [2]: Install Web Server (Apache), PHP and PHP Support for Apache, and other extensions (php-mysql)
# [3]: Run Apache Web Server - https://stackoverflow.com/questions/49764989/cannot-start-apache-automatically-with-docker