# syntax=docker/dockerfile:1
ARG CONTAINER_IMAGE

FROM ${CONTAINER_IMAGE}
#ARG DEBIAN_FRONTEND=noninteractive

# ====[ DEPENDENCIES ]====
# Settings for tzdata - https://serverfault.com/questions/949991/how-to-install-tzdata-on-a-ubuntu-docker-image
ENV TZ=Europe/Rome
RUN apt-get update

# ====[ PHP EXTENSION ]====
# 1.1 MySQL DATABASE
RUN docker-php-ext-configure mysqli
RUN docker-php-ext-install -j$(nproc) mysqli
RUN docker-php-ext-install pdo pdo_mysql
RUN docker-php-ext-enable mysqli

# 1.2 GD (Graphic Draw)
RUN apt-get install -y \
		libfreetype-dev \
		libjpeg62-turbo-dev \
		libpng-dev \
	&& docker-php-ext-configure gd --with-freetype --with-jpeg \
	&& docker-php-ext-install -j$(nproc) gd

# 1.3 ZIP
RUN apt-get install -y zip libzip-dev
RUN docker-php-ext-configure zip
RUN docker-php-ext-install zip

# 1.4 OPCACHE
RUN docker-php-ext-install opcache

# 1.5 INTL
RUN apt-get install -y libicu-dev
RUN docker-php-ext-configure intl
RUN docker-php-ext-install intl

# 1.6 XDEBUG
RUN pecl install xdebug
RUN docker-php-ext-enable xdebug


# Install Web Server: Apache
#RUN apt install apache2 -y
# Install PHP and PHP Support for Apache, and other extensions (php-mysql)
#RUN apt install php libapache2-mod-php php-bcmath php-curl php-imagick php-intl php-json php-mbstring php-mysql php-xml php-zip -y
# Install database MySQL - NO-THREE TIER ARCHITECTURE
#RUN apt install mysql-server -y

# ====[ SET UP FTWS ]====
#RUN mkdir -p /srv/ftws
#COPY ./ftws /srv/ftws
#COPY ftws-vhost.conf /etc/apache2/sites-available/ftws.conf

#RUN a2ensite ftws
#RUN chown -R www-data:www-data /srv/ftws

#RUN a2dissite 000-default

# ====[ RUN SERVICES ]====
# Run Apache Web Server - https://stackoverflow.com/questions/49764989/cannot-start-apache-automatically-with-docker
#CMD ["/usr/sbin/apachectl", "-D", "FOREGROUND"]


